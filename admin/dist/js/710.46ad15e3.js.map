{"version":3,"file":"js/710.46ad15e3.js","mappings":"+OACSA,MAAM,0B,GACPC,EAAAA,EAAAA,GAAwB,YAAlB,eAAW,G,GAGjBA,EAAAA,EAAAA,GAA0B,YAApB,iBAAa,G,GACdD,MAAM,qC,mIALfE,EAAAA,EAAAA,IAWM,MAXNC,EAWM,CAVFC,GACAC,EAAAA,EAAAA,IACsEC,EAAAA,CADzDC,MAAM,OAAQC,QAAS,CAAC,OAAQ,SAAU,YAAa,UAAWC,IAAI,iBAC/EC,GAAG,iBAAiBC,YAAY,mBAAmBX,MAAM,Q,UAC7DY,GACAX,EAAAA,EAAAA,GAEM,MAFNY,EAEM,EADFZ,EAAAA,EAAAA,GAAwC,OAAlCa,IAAKC,EAAAA,QAASf,MAAM,a,aAE9BK,EAAAA,EAAAA,IAC2BW,EAAAA,CADfC,KAAK,OAAOC,OAAO,UAAUT,IAAI,UAAWU,QAAOC,EAAAA,kBAAmBpB,MAAM,OAAOqB,MAAM,SACjGV,YAAY,U,qBAChBN,EAAAA,EAAAA,IAA8DiB,EAAAA,CAArDC,MAAM,UAAWC,QAAOJ,EAAAA,U,mBAAU,IAAS,UAAT,gB,iEAanD,MAAMK,EAAQC,IAAAA,OAAa,CACvBC,iBAAiB,IAGrB,OACIC,WAAY,CACRC,YAAWA,EAAAA,IAEfC,OACI,MAAO,CACHL,MAAOA,EACPM,QAAS,KACTC,MAAO,KAEf,EACAC,UACA,EACAC,QAAS,CACLC,kBAAkBC,GACd,IAAIC,EAAQD,EAAME,OAElB,GAAID,EAAME,MAAO,CACb,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,OAAUC,IACbC,KAAKb,QAAUY,EAAEL,OAAOO,MAAM,EAElCD,KAAKZ,MAAQK,EAAME,MAAM,GACzBC,EAAOM,cAAcT,EAAME,MAAM,GACrC,CACJ,EACAQ,WAEI,IACI,MAAMC,EAAWJ,KAAKK,oBAEtBxB,EACKyB,KAAKN,KAAKO,OAAOC,MAAMC,WAAa,qBAAsBL,EAAU,CACjEM,QAAS,CACL,eAAgB,yBAGvBC,MAAK,KACFX,KAAKY,MAAMC,eAAeC,QAAQ,IAClCd,KAAKb,QAAU,KACfa,KAAKZ,MAAQ,KACb2B,SAASC,cAAc,oBAAoBC,MAAQ,EAAE,IAExDC,OAAOnB,IACJoB,EAAAA,EAAAA,MAAe,aAAcpB,EAAE,GAI3C,CAFE,MAAOA,GACLoB,EAAAA,EAAAA,MAAe,iBAAkBpB,EACrC,CAEJ,EACAM,oBACI,IAAKL,KAAKY,MAAMC,eAAeO,UAC3B,MAAM,IAAIC,MAEd,IAAIjB,EAAW,IAAIkB,SAUnB,OAPAtB,KAAKZ,OAASgB,EAASmB,OAAQ,UAAUvB,KAAKZ,OAE9CgB,EAASmB,OACL,OACAvB,KAAKY,MAAMC,eAAeO,WAGvBhB,CACX,I,QCvFR,MAAMoB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://@coreui/coreui-free-vue-admin-template/./src/views/Mailing.vue","webpack://@coreui/coreui-free-vue-admin-template/./src/views/Mailing.vue?13c6"],"sourcesContent":["<template>\r\n    <div class=\"mailing-block card p-3\">\r\n        <span>Текст поста</span>\r\n        <QuillEditor theme=\"snow\" :toolbar=\"['bold', 'italic', 'underline', 'strike']\" ref=\"postTextEditor\"\r\n            id=\"postTextEditor\" placeholder=\"Краткое описание\" class=\"mb-3\" />\r\n        <span>Обложка поста</span>\r\n        <div class=\"border p-2 mb-3 preview-container\">\r\n            <img :src=\"preview\" class=\"img-fluid\" />\r\n        </div>\r\n        <CFormInput type=\"file\" accept=\"image/*\" ref=\"preview\" @input=\"previewMultiImage\" class=\"mb-3\" label=\"Превью\"\r\n            placeholder=\"Превью\" />\r\n        <CButton color=\"primary\" @click=\"sendPost\">Разослать</CButton>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { QuillEditor } from '@vueup/vue-quill'\r\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\r\n//import TurndownService from 'turndown'\r\n//import { marked } from 'marked'\r\n//import * as DOMPurify from 'dompurify'\r\nimport eventBus from '../eventBus'\r\n\r\nimport axios from 'axios'\r\nconst myApi = axios.create({\r\n    withCredentials: true,\r\n})\r\n\r\nexport default {\r\n    components: {\r\n        QuillEditor\r\n    },\r\n    data() {\r\n        return {\r\n            myApi: myApi,\r\n            preview: null,\r\n            photo: null,\r\n        }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n        previewMultiImage(event) {\r\n            var input = event.target;\r\n\r\n            if (input.files) {\r\n                var reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    this.preview = e.target.result;\r\n                }\r\n                this.photo = input.files[0];\r\n                reader.readAsDataURL(input.files[0]);\r\n            }\r\n        },\r\n        sendPost() {\r\n\r\n            try {\r\n                const formData = this.constractFromData()\r\n\r\n                myApi\r\n                    .post(this.$store.state.publicPath + '/api/admin/mailing', formData, {\r\n                        headers: {\r\n                            'Content-Type': 'multipart/form-data',\r\n                        },\r\n                    })\r\n                    .then(() => {\r\n                        this.$refs.postTextEditor.setHTML(\"\")\r\n                        this.preview = null;\r\n                        this.photo = null;\r\n                        document.querySelector('input[type=file]').value = '';\r\n                    })\r\n                    .catch((e) => {\r\n                        eventBus.$emit('noresponse', e)\r\n                    })\r\n            } catch (e) {\r\n                eventBus.$emit('wrongInputData', e)\r\n            }\r\n\r\n        },\r\n        constractFromData() {\r\n            if (!this.$refs.postTextEditor.getHTML())\r\n                throw new Error()\r\n\r\n            var formData = new FormData()\r\n\r\n\r\n            this.photo && formData.append(`preview`, this.photo);\r\n\r\n            formData.append(\r\n                'text',\r\n                this.$refs.postTextEditor.getHTML(),\r\n            )\r\n\r\n            return formData\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nbutton {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.mailing-block {\r\n\r\n    &>span,\r\n    &>label {\r\n        margin-bottom: 1rem;\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./Mailing.vue?vue&type=template&id=3db58ba9\"\nimport script from \"./Mailing.vue?vue&type=script&lang=js\"\nexport * from \"./Mailing.vue?vue&type=script&lang=js\"\n\nimport \"./Mailing.vue?vue&type=style&index=0&id=3db58ba9&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\Ник\\\\Documents\\\\GitHub\\\\tg-vapeshop\\\\admin\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_createVNode","_component_QuillEditor","theme","toolbar","ref","id","placeholder","_hoisted_3","_hoisted_4","src","$data","_component_CFormInput","type","accept","onInput","$options","label","_component_CButton","color","onClick","myApi","axios","withCredentials","components","QuillEditor","data","preview","photo","created","methods","previewMultiImage","event","input","target","files","reader","FileReader","onload","e","this","result","readAsDataURL","sendPost","formData","constractFromData","post","$store","state","publicPath","headers","then","$refs","postTextEditor","setHTML","document","querySelector","value","catch","eventBus","getHTML","Error","FormData","append","__exports__","render"],"sourceRoot":""}