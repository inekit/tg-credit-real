"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[967],{4967:function(t,e,r){r.r(e),r.d(e,{default:function(){return _}});var i=r(3396);const n=(0,i._)("span",null,"Текст поста",-1),o=(0,i._)("span",null,"Обложка поста",-1),a={class:"border p-2 mt-3 preview-container"},s=["src"];function l(t,e,r,l,p,u){const c=(0,i.up)("QuillEditor"),d=(0,i.up)("CFormInput"),h=(0,i.up)("CButton");return(0,i.wg)(),(0,i.iD)("div",null,[n,(0,i.Wm)(c,{theme:"snow",toolbar:["bold","italic","underline","strike"],ref:"postTextEditor",id:"postTextEditor",placeholder:"Краткое описание"},null,512),o,(0,i._)("div",a,[(0,i._)("img",{src:p.preview,class:"img-fluid"},null,8,s)]),(0,i.Wm)(d,{type:"file",accept:"image/*",ref:"preview",onInput:u.previewMultiImage,class:"mb-3",label:"Превью",placeholder:"Превью"},null,8,["onInput"]),(0,i.Wm)(h,{color:"primary",onClick:u.sendPost},{default:(0,i.w5)((()=>[(0,i.Uk)("Разослать")])),_:1},8,["onClick"])])}var p=r(6149),u=r(2777),c=r(7123),d=r(6265),h=r.n(d);const m=h().create({withCredentials:!0});var f={components:{QuillEditor:p.Bn},data(){return{myApi:m,preview:null,photo:null}},created(){},methods:{previewMultiImage(t){var e=t.target;if(e.files){var r=new FileReader;r.onload=t=>{this.preview=t.target.result},this.photo=e.files[0],r.readAsDataURL(e.files[0])}},sendPost(){try{const t=this.constractFromData();m.post(this.$store.state.publicPath+"/api/admin/mailing",t,{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{this.$refs.postTextEditor.setHTML(""),this.preview=null,this.photo=null})).catch((t=>{c.Z.$emit("noresponse",t)}))}catch(t){c.Z.$emit("wrongInputData",t)}},constractFromData(){if(!this.$refs.postTextEditor.getHTML())throw new Error;var t=new FormData;this.photo&&t.append("preview",this.photo);const e=new u.Z({headingStyle:"atx"});return t.append("text",e.turndown(this.$refs.postTextEditor.getHTML())),t}}},w=r(89);const v=(0,w.Z)(f,[["render",l]]);var _=v}}]);
//# sourceMappingURL=967.8c3354f4.js.map