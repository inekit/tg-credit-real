(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[888],{4234:function(t){let a={year:"numeric",month:"long",day:"numeric"};t.exports={dateFormatter:t=>t?new Date(t).toLocaleDateString("ru-RU",a):"",getAgeStr(t){return t>12?`${Math.trunc(t/12)} лет ${t%12} месяцев`:`${t} месяцев`}}},1888:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return A}});var s=e(3396),n=e(7139),i=e(9242);const l={class:"card mb-4 order-card"},o={key:0,class:"img-container mb-3"},r=(0,s._)("label",null,"Фото паспорта",-1),u=["src"],d={key:1,class:"img-container mb-3"},c=(0,s._)("label",null,"Фото визы",-1),m=["src"],_={key:2},h={key:3},p={key:4},w={key:5},g={key:6,class:"change-status"},v={key:0},b=(0,s._)("span",{class:"w-100 mb-2"},"Изменить статус",-1),k=["onClick"],y={key:1},z={key:0},D=(0,s._)("span",{class:"w-100 mb-2"},"Оцените клиента и завершите заказ",-1);function $(t,a,e,$,f,F){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",l,[(0,s._)("div",null," ID: "+(0,n.zw)(f.loan.id),1),(0,s._)("div",null," Дата создания: "+(0,n.zw)(F.dateFormatter(f.loan.creation_date)),1),(0,s._)("div",null," ID заемщика: "+(0,n.zw)(f.loan.user_id),1),(0,s._)("div",null," Юзернейм Телеграм: "+(0,n.zw)(f.loan.username?`@${f.loan.username}`:"Нет"),1),(0,s._)("div",null," ФИО получателя: "+(0,n.zw)(`${f.loan.surname} ${f.loan.name} ${f.loan.patronymic}`),1),(0,s._)("div",null," Телефон: "+(0,n.zw)(f.loan.phone),1),(0,s._)("div",null," Дата рождения: "+(0,n.zw)(F.dateFormatter(f.loan.birth_date)),1),f.loan.passport_photo?((0,s.wg)(),(0,s.iD)("div",o,[r,(0,s._)("img",{src:`${t.$store.state.publicPath}/public/pics/${f.loan.passport_photo}`},null,8,u)])):(0,s.kq)("",!0),f.loan.visa_photo?((0,s.wg)(),(0,s.iD)("div",d,[c,(0,s._)("img",{src:`${t.$store.state.publicPath}/public/pics/${f.loan.visa_photo}`},null,8,m)])):(0,s.kq)("",!0),(0,s._)("div",null," Дата окончания визы: "+(0,n.zw)(F.dateFormatter(f.loan.visa_expired_date)),1),(0,s._)("div",null," Сумма займа: "+(0,n.zw)(f.loan.sum),1),(0,s._)("div",null," Сумма к возврату: "+(0,n.zw)(f.loan.return_sum),1),(0,s._)("div",null," Срок займа (в днях): "+(0,n.zw)(f.loan.term_days),1),(0,s._)("div",null," Способ выдачи: "+(0,n.zw)(f.loan.atm),1),(0,s._)("div",null," Способ возврата: "+(0,n.zw)(f.loan.return_method),1),f.loan.issue_date?((0,s.wg)(),(0,s.iD)("div",_," Дата выдачи: "+(0,n.zw)(F.dateFormatter(f.loan.issue_date)),1)):(0,s.kq)("",!0),f.loan.return_date?((0,s.wg)(),(0,s.iD)("div",h," Дата возврата: "+(0,n.zw)(F.dateFormatter(f.loan.return_date)),1)):(0,s.kq)("",!0),(0,s._)("div",null," Страна: "+(0,n.zw)(f.loan.country),1),f.loan.aprooved_by_id?((0,s.wg)(),(0,s.iD)("div",p," ID ответственного администратора: "+(0,n.zw)(f.loan.aprooved_by_id),1)):(0,s.kq)("",!0),f.loan.assessment?((0,s.wg)(),(0,s.iD)("div",w," Оценка заемщика: "+(0,n.zw)(f.loan.assessment),1)):(0,s.kq)("",!0),(0,s._)("div",null," Статус: "+(0,n.zw)(f.loan.status),1),f.statuses.length?((0,s.wg)(),(0,s.iD)("div",g,["На возврате"!==f.loan.status?((0,s.wg)(),(0,s.iD)("div",v,[b,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(f.statuses,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t,class:"btn btn-primary",onClick:a=>F.changeStatus(t)},(0,n.zw)(t),9,k)))),128))])):((0,s.wg)(),(0,s.iD)("div",y,[(0,s._)("button",{class:"btn btn-danger",onClick:a[0]||(a[0]=t=>F.changeStatus("Получен"))},"Займ не возвращен"),(0,s._)("button",{onClick:a[1]||(a[1]=t=>f.showFinish=!0)},"Займ возвращен"),f.showFinish?((0,s.wg)(),(0,s.iD)("div",z,[D,(0,s.wy)((0,s._)("input",{type:"range",min:"1",max:"5","onUpdate:modelValue":a[2]||(a[2]=t=>f.assessment=t)},null,512),[[i.nr,f.assessment]]),(0,s._)("button",{class:"btn btn-primary",onClick:a[3]||(a[3]=t=>F.changeStatus("Закрыт"))},"Оценить и подтвердить возврат займа")])):(0,s.kq)("",!0)]))])):(0,s.kq)("",!0)])])}var f=e(7123),F=e(4234),S=e(6265),q=e.n(S);const C=q().create({withCredentials:!0,credentials:"include"});var I={components:{},props:["loanId"],data(){return{myApi:C,formVisible:!1,formData:{},loan:{},rows:[],statuses:[],assessment:5,messageTemplate:null,showFinish:!1,tableFieldNames:[{name:"id",title:"Артикул"},{name:"title",title:"Название"},{name:"option_name",title:"Опция"},{name:"count",title:"Количество"}]}},async created(){await this.get(),this.printStatuses()},methods:{printStatuses(){this.statuses="Новый"===this.loan.status?["Выдан","Запрещен"]:"На возврате"===this.loan.status?["Получен","Закрыт"]:(this.loan.status,[])},change(t){this.formVisible=!0,t.tags_array=new Set(t.tags_array),this.formData=t,console.log(t),this.formMode="edit"},dateFormatter:F.dateFormatter,changeStatus(t){this.$store.state.myApi.put(this.$store.state.publicPath+"/api/admin/loans",{user_id:this.loan.user_id,status:t,assessment:this.assessment}).then((async()=>{this.loan.status=t,this.printStatuses(),this.loan.assessment=this.assessment})).catch((t=>{f.Z.$emit("noresponse",t)}))},get(){return console.log(this.tag),C.get(this.$store.state.publicPath+"/api/admin/loans/",{params:{id:this.$route.params.loanId}}).then((t=>{this.loan=t.data?.[0]})).catch((t=>(f.Z.$emit("noresponse",t),!1)))}}},P=e(89);const x=(0,P.Z)(I,[["render",$]]);var A=x}}]);
//# sourceMappingURL=888.a9df9932.js.map