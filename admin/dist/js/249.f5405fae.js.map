{"version":3,"file":"js/249.f5405fae.js","mappings":"8OAEQA,EAAAA,EAAAA,GAAwB,YAAlB,eAAW,G,GAGjBA,EAAAA,EAAAA,GAA0B,YAApB,iBAAa,G,GACdC,MAAM,qC,mIALfC,EAAAA,EAAAA,IAWM,YAVFC,GACAC,EAAAA,EAAAA,IACqCC,EAAAA,CADxBC,MAAM,OAAOC,QAAQ,YAAYC,IAAI,iBAAiBC,GAAG,iBAClEC,YAAY,oB,UAChBC,GACAX,EAAAA,EAAAA,GAEM,MAFNY,EAEM,EADFZ,EAAAA,EAAAA,GAAwC,OAAlCa,IAAKC,EAAAA,QAASb,MAAM,a,aAE9BG,EAAAA,EAAAA,IAC2BW,EAAAA,CADfC,KAAK,OAAOC,OAAO,UAAUT,IAAI,UAAWU,QAAOC,EAAAA,kBAAmBlB,MAAM,OAAOmB,MAAM,SACjGV,YAAY,U,qBAChBN,EAAAA,EAAAA,IAA8DiB,EAAAA,CAArDC,MAAM,UAAWC,QAAOJ,EAAAA,U,mBAAU,IAAS,UAAT,gB,2EAanD,MAAMK,EAAQC,IAAAA,OAAa,CACvBC,iBAAiB,IAGrB,OACIC,WAAY,CACRC,YAAWA,EAAAA,IAEfC,OACI,MAAO,CACHL,MAAOA,EACPM,QAAS,KACTC,MAAO,KAEf,EACAC,UACA,EACAC,QAAS,CACLC,kBAAkBC,GACd,IAAIC,EAAQD,EAAME,OAElB,GAAID,EAAME,MAAO,CACb,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,OAAUC,IACbC,KAAKb,QAAUY,EAAEL,OAAOO,MAAM,EAElCD,KAAKZ,MAAQK,EAAME,MAAM,GACzBC,EAAOM,cAAcT,EAAME,MAAM,GACrC,CACJ,EACAQ,WAEI,IACI,MAAMC,EAAWJ,KAAKK,oBAEtBxB,EACKyB,KAAKN,KAAKO,OAAOC,MAAMC,WAAa,qBAAsBL,EAAU,CACjEM,QAAS,CACL,eAAgB,yBAGvBC,MAAK,KACFC,EAAAA,EAAAA,MAAe,YAAY,IAE9BC,OAAOd,IACJa,EAAAA,EAAAA,MAAe,aAAcb,EAAE,GAK3C,CAHE,MAAOA,GACLC,KAAKc,WAAY,CAErB,CAEJ,EACAT,oBACI,IAAKL,KAAKe,MAAMC,eAAeC,UAC3B,MAAM,IAAIC,MAEd,IAAId,EAAW,IAAIe,SAGnBnB,KAAKZ,OAASgB,EAASgB,OAAQ,UAAUpB,KAAKZ,OAG9C,MAAMiC,EAAkB,IAAIC,EAAAA,EAAgB,CACxCC,aAAc,QAYlB,OAPAnB,EAASgB,OACL,OACAC,EAAgBG,SAASxB,KAAKe,MAAMC,eAAeC,YAGvDjB,KAAKe,MAAMC,eAAeS,QAAQ,IAE3BrB,CACX,I,QC9FR,MAAMsB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://@coreui/coreui-free-vue-admin-template/./src/views/Mailing.vue","webpack://@coreui/coreui-free-vue-admin-template/./src/views/Mailing.vue?13c6"],"sourcesContent":["<template>\r\n    <div>\r\n        <span>Текст поста</span>\r\n        <QuillEditor theme=\"snow\" toolbar=\"essential\" ref=\"postTextEditor\" id=\"postTextEditor\"\r\n            placeholder=\"Краткое описание\" />\r\n        <span>Обложка поста</span>\r\n        <div class=\"border p-2 mt-3 preview-container\">\r\n            <img :src=\"preview\" class=\"img-fluid\" />\r\n        </div>\r\n        <CFormInput type=\"file\" accept=\"image/*\" ref=\"preview\" @input=\"previewMultiImage\" class=\"mb-3\" label=\"Превью\"\r\n            placeholder=\"Превью\" />\r\n        <CButton color=\"primary\" @click=\"sendPost\">Разослать</CButton>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { QuillEditor } from '@vueup/vue-quill'\r\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\r\nimport TurndownService from 'turndown'\r\n//import { marked } from 'marked'\r\n//import * as DOMPurify from 'dompurify'\r\nimport eventBus from '../eventBus'\r\n\r\nimport axios from 'axios'\r\nconst myApi = axios.create({\r\n    withCredentials: true,\r\n})\r\n\r\nexport default {\r\n    components: {\r\n        QuillEditor\r\n    },\r\n    data() {\r\n        return {\r\n            myApi: myApi,\r\n            preview: null,\r\n            photo: null,\r\n        }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n        previewMultiImage(event) {\r\n            var input = event.target;\r\n\r\n            if (input.files) {\r\n                var reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    this.preview = e.target.result;\r\n                }\r\n                this.photo = input.files[0];\r\n                reader.readAsDataURL(input.files[0]);\r\n            }\r\n        },\r\n        sendPost() {\r\n\r\n            try {\r\n                const formData = this.constractFromData()\r\n\r\n                myApi\r\n                    .post(this.$store.state.publicPath + '/api/admin/mailing', formData, {\r\n                        headers: {\r\n                            'Content-Type': 'multipart/form-data',\r\n                        },\r\n                    })\r\n                    .then(() => {\r\n                        eventBus.$emit('postAdded')\r\n                    })\r\n                    .catch((e) => {\r\n                        eventBus.$emit('noresponse', e)\r\n                    })\r\n            } catch (e) {\r\n                this.formValid = true\r\n                //eventBus.$emit('wrongInputData', e)\r\n            }\r\n\r\n        },\r\n        constractFromData() {\r\n            if (!this.$refs.postTextEditor.getHTML())\r\n                throw new Error()\r\n\r\n            var formData = new FormData()\r\n\r\n\r\n            this.photo && formData.append(`preview`, this.photo);\r\n\r\n\r\n            const turndownService = new TurndownService({\r\n                headingStyle: \"atx\",\r\n                //bulletListMarker: \"-\",\r\n                //fence: \"~~~\",\r\n                //emDelimiter: \"*\",\r\n            })\r\n            formData.append(\r\n                'text',\r\n                turndownService.turndown(this.$refs.postTextEditor.getHTML()),\r\n            )\r\n\r\n            this.$refs.postTextEditor.setHTML(\"\")\r\n\r\n            return formData\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nbutton {\r\n    margin-bottom: 20px;\r\n}\r\n</style>\r\n","import { render } from \"./Mailing.vue?vue&type=template&id=a83a727e\"\nimport script from \"./Mailing.vue?vue&type=script&lang=js\"\nexport * from \"./Mailing.vue?vue&type=script&lang=js\"\n\nimport \"./Mailing.vue?vue&type=style&index=0&id=a83a727e&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\Ник\\\\Documents\\\\GitHub\\\\tg-vapeshop\\\\admin\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","_createElementBlock","_hoisted_1","_createVNode","_component_QuillEditor","theme","toolbar","ref","id","placeholder","_hoisted_2","_hoisted_3","src","$data","_component_CFormInput","type","accept","onInput","$options","label","_component_CButton","color","onClick","myApi","axios","withCredentials","components","QuillEditor","data","preview","photo","created","methods","previewMultiImage","event","input","target","files","reader","FileReader","onload","e","this","result","readAsDataURL","sendPost","formData","constractFromData","post","$store","state","publicPath","headers","then","eventBus","catch","formValid","$refs","postTextEditor","getHTML","Error","FormData","append","turndownService","TurndownService","headingStyle","turndown","setHTML","__exports__","render"],"sourceRoot":""}