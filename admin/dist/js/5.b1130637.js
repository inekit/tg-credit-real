"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[5],{4005:function(e,t,r){r.r(t),r.d(t,{default:function(){return w}});var i=r(3396);const o=(0,i._)("span",null,"Текст поста",-1),n=(0,i._)("span",null,"Обложка поста",-1),a={class:"border p-2 mt-3 preview-container"},l=["src"];function s(e,t,r,s,p,u){const c=(0,i.up)("QuillEditor"),d=(0,i.up)("CFormInput"),h=(0,i.up)("CButton");return(0,i.wg)(),(0,i.iD)("div",null,[o,(0,i.Wm)(c,{theme:"snow",toolbar:["bold","italic","underline","strike"],ref:"postTextEditor",id:"postTextEditor",placeholder:"Краткое описание"},null,512),n,(0,i._)("div",a,[(0,i._)("img",{src:p.preview,class:"img-fluid"},null,8,l)]),(0,i.Wm)(d,{type:"file",accept:"image/*",ref:"preview",onInput:u.previewMultiImage,class:"mb-3",label:"Превью",placeholder:"Превью"},null,8,["onInput"]),(0,i.Wm)(h,{color:"primary",onClick:u.sendPost},{default:(0,i.w5)((()=>[(0,i.Uk)("Разослать")])),_:1},8,["onClick"])])}var p=r(6149),u=r(7123),c=r(6265),d=r.n(c);const h=d().create({withCredentials:!0});var m={components:{QuillEditor:p.Bn},data(){return{myApi:h,preview:null,photo:null}},created(){},methods:{previewMultiImage(e){var t=e.target;if(t.files){var r=new FileReader;r.onload=e=>{this.preview=e.target.result},this.photo=t.files[0],r.readAsDataURL(t.files[0])}},sendPost(){try{const e=this.constractFromData();h.post(this.$store.state.publicPath+"/api/admin/mailing",e,{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{this.$refs.postTextEditor.setHTML(""),this.preview=null,this.photo=null,document.querySelector("input[type=file]").value=""})).catch((e=>{u.Z.$emit("noresponse",e)}))}catch(e){u.Z.$emit("wrongInputData",e)}},constractFromData(){if(!this.$refs.postTextEditor.getHTML())throw new Error;var e=new FormData;return this.photo&&e.append("preview",this.photo),e.append("text",this.$refs.postTextEditor.getHTML()),e}}},f=r(89);const v=(0,f.Z)(m,[["render",s]]);var w=v}}]);
//# sourceMappingURL=5.b1130637.js.map